[gcode_macro CLEAN_NOZZLE]
gcode:
   {% if "xyz" in printer.toolhead.homed_axes %}
      SAVE_GCODE_STATE NAME=CLEAN_NOZZLE

      G92 E0
      M82
      G0 Z5 F5000                                                   # Z hop

      G90
      G1 X30 Y297 F18000

      {% for wipes in range(1, 4) %}
         G1 X75 F10000
         G1 X30 F10000
      {% endfor %}
   
      RESTORE_GCODE_STATE NAME=CLEAN_NOZZLE
   {% endif %}
 