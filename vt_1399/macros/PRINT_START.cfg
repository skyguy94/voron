[gcode_macro PRINT_START]
gcode:
    EXCLUDE_OBJECT_DEFINE
    SKEW_PROFILE LOAD=CaliFlower

    {% set bed = params.BED| default(60) | int %}
    {% set extruder = params.EXTRUDER| default(150) | int %}
    {% set chamber = params.CHAMBER | default(30) | float %}
    {% set timeout = (params.TIMEOUT | default(5) | int) * 60 %}

    {% if "xyz" not in printer.toolhead.homed_axes %}
        G28
    {% endif %}

    { action_respond_info("Heating bed %d" % bed) }
    M117 Heating bed: { bed }
    M190 S{ bed }

    G28 Z

    { action_respond_info("Calibrating bed") }
    M117 Calibrating bed
    Z_TILT_ADJUST

    G28 Z

    BED_MESH_CALIBRATE ADAPTIVE=1
    CARTOGRAPHER_TOUCH

    { action_respond_info("Heating hotend %d" % extruder) }
    M117 Hotend: { extruder }
    M109 S{ extruder }